define(["core/CoreBundle","nv.d3.min"],function(){function d(a){Apple.call(this,a);this.height=a.height?a.height:400;this.captionLength=a.captionLength;this.xAxisFormat=a.xAxisFormat?a.xAxisFormat:function(a,c){return truncateString(a,this.captionLength).replace("&hellip;","...")}}d.prototype=new Apple;d.prototype.constructor=d;d.prototype.getView=function(){return this.view=$('<div id="'+this.divid+'">  <svg style="height: '+this.height+'px;" class="nvd3"></svg></div> ')};d.prototype.updateValues=
function(){var a=this;nv.addGraph(function(){a.chart=a.chart?a.chart:window.nv.models.discreteBarChart().x(function(a){return a.key.ToCaption()}).y(function(a){return a.y}).tooltips(!0).staggerLabels(!0).tooltipContent(function(b){return"<h3>"+b.data.key.ToCaption()+"</h3><p>"+d3.locale(a.locale).numberFormat(a.numberFormat)(b.data.y)+"</p>"}).color(a.colors);a.chart.xAxis.tickFormat(a.xAxisFormat);d3.select("#"+a.divid+" svg").datum(a.testdata()).transition().duration(1200).call(a.chart);a.click&&
(d3.selectAll("#"+a.divid+" .discreteBar").style("cursor","hand"),a.chart.discretebar.dispatch.on("elementClick",function(b){a.click(b.data.key,b.data.y)}));if(a.actAsFilter)a.chart.discretebar.dispatch.on("elementClick",function(b){a.selected=b.data.key;a.selectedBar&&a.selectedBar.style("fill",a.selectedStyle);if(a.parent)a.parent.onSelectionChanged(a)});nv.utils.windowResize(a.chart.update);return a.chart})};d.prototype.testdata=function(){for(var a=this.axis0.Tuples().ToArray(),b=[],c=this.textIndex=
0;c<a[0].elements.length;c++)"text"==a[0].elements[c].Dimension.Caption&&(this.textIndex=c);for(c=0;c<a.length;c++)b.push({key:a[c],y:this.getValue(a[c])});return[{key:"Cumulative Return",values:b}]};d.prototype.getSelection=function(){var a=[];this.selected&&a.push(this.selected);return Enumerable.From(a)};return function(a){return new d.prototype.constructor(a)}});
